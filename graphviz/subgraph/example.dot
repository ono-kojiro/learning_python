digraph mygraph {
    rankdir="LR";
    ordering=out;

    //newrank = true;
    nodesep="0.1";
    ranksep="0.1";

    subgraph cluster_Modem {
        label = "Modem\n192.168.0.1";
        modem_image [
            shape=none
            image="icons/doc_jpg/small_hub.png"
            label=none
        ];

        modem_port5 [ shape=rectangle label="5"
            fixedsize=true width=0.3 height=0.3 ];
        modem_port4 [ shape=rectangle label="4"
            fixedsize=true width=0.3 height=0.3 ];
        modem_port3 [ shape=rectangle label="3"
            fixedsize=true width=0.3 height=0.3 ];
        modem_port2 [ shape=rectangle label="2"
            fixedsize=true width=0.3 height=0.3 ];
        modem_port1 [ shape=rectangle label="1"
            fixedsize=true width=0.3 height=0.3 ];

        {
            rank = same;
            modem_port5; modem_port4; modem_port3; modem_port2;
        }
        modem_port1 -> modem_image [color=none, penwidth=1, weight=10];
        modem_image -> modem_port5 [color=none, penwidth=1];
        modem_image -> modem_port4 [color=none, penwidth=1];
        modem_image -> modem_port3 [color=none, penwidth=1];
        modem_image -> modem_port2 [color=none, penwidth=1];

        /* fix order */
        modem_port4 -> modem_port5 [color=none];
        modem_port3 -> modem_port4 [color=none];
        modem_port2 -> modem_port3 [color=none];
    };

    subgraph cluster_Switch1 {
        label = "CISCO Switch\n192.168.0.248";
        // 1. define last node first
        sw1_port8 [ shape=rectangle label="8"
            fixedsize=true width=0.3 height=0.3 ];

        sw1_image [
            shape=none
            image="icons/doc_jpg/small_hub.png"
            label=none
        ];
        
        sw1_port1 [ shape=rectangle label="1"
            fixedsize=true width=0.3 height=0.3 ];
        sw1_port2 [ shape=rectangle label="2"
            fixedsize=true width=0.3 height=0.3 ];
        sw1_port3 [ shape=rectangle label="3"
            fixedsize=true width=0.3 height=0.3 ];

        sw1_port4 [ shape=rectangle label="4"
            fixedsize=true width=0.3 height=0.3 ];
        sw1_port5 [ shape=rectangle label="5"
            fixedsize=true width=0.3 height=0.3 ];
        sw1_port6 [ shape=rectangle label="6"
            fixedsize=true width=0.3 height=0.3 ];
        sw1_port7 [ shape=rectangle label="7"
            fixedsize=true width=0.3 height=0.3 ];

        {
            rank = same;
            sw1_port1,
            sw1_port2, sw1_port3 sw1_port4
            sw1_port5 sw1_port6 sw1_port7
        }

        // order
        sw1_port8 -> sw1_image [color=none, penwidth=1, weight=10];
        
        sw1_image -> sw1_port7 [color=none, penwidth=1];
        sw1_image -> sw1_port6 [color=none, penwidth=1, weight=10];
        
        sw1_image -> sw1_port5 [color=none, penwidth=1];
        sw1_image -> sw1_port4 [color=none, penwidth=1];
        sw1_image -> sw1_port3 [color=none, penwidth=1];
        sw1_image -> sw1_port2 [color=none, penwidth=1];
        sw1_image -> sw1_port1 [color=none, penwidth=1];

        /* fix order */
        sw1_port1 -> sw1_port2 [color=none];
        sw1_port2 -> sw1_port3 [color=black, weight=50];
        sw1_port3 -> sw1_port4 [color=black];
        sw1_port4 -> sw1_port5 [color=none];
        sw1_port5 -> sw1_port6 [color=none];
        sw1_port6 -> sw1_port7 [color=none];
    };


    subgraph cluster_Switch2 {
        label = "Buffalo Swtich\n192.168.0.252";
        sw2_image [
            shape=none
            image="icons/doc_jpg/small_hub.png"
            label=none
        ];

        sw2_port8 [ shape=box label="8" fixedsize=true width=0.3 height=0.3 ];
        sw2_port1 [
            shape=box
            label="1"
            fixedsize=true
            width=0.3
            height=0.3
        ];
        sw2_port3 [
            shape=box
            label="3"
            fixedsize=true
            width=0.3
            height=0.3
        ];
        sw2_port2 [
            shape=box
            label="2"
            fixedsize=true
            width=0.3
            height=0.3
        ];
        sw2_port4 [ shape=box label="4" fixedsize=true width=0.3 height=0.3 ];
        sw2_port5 [ shape=box label="5" fixedsize=true width=0.3 height=0.3 ];
        sw2_port6 [ shape=box label="6" fixedsize=true width=0.3 height=0.3 ];
        sw2_port7 [ shape=box label="7" fixedsize=true width=0.3 height=0.3 ];

        { rank = same; sw2_port3 sw2_port2 sw2_port1 sw2_port5 
            sw2_port6 sw2_port7 sw2_port8
        }
        sw2_port4 -> sw2_image [color=none, weight=10];
        sw2_image -> sw2_port8 [color=none];
        sw2_image -> sw2_port7 [color=none];
        sw2_image -> sw2_port6 [color=none];
        sw2_image -> sw2_port5 [color=none, weight=10];
        sw2_image -> sw2_port3 [color=none];
        sw2_image -> sw2_port2 [color=none];
        sw2_image -> sw2_port1 [color=none];
        
        /* fix order */
        sw1_port1 -> sw1_port2 [color=none];
        sw1_port2 -> sw1_port3 [color=none];
        sw1_port3 -> sw1_port5 [color=none];
        sw1_port5 -> sw1_port6 [color=none];
        sw1_port6 -> sw1_port7 [color=none];
        sw1_port7 -> sw1_port8 [color=none];
    };
    
    subgraph cluster_Desktop {
        label = "DELL Optiplex Micro\n192.168.0.52";
        micro_port1 [
            shape=box
            label="1"
            fixedsize=true
            width=0.3
            height=0.3
        ];
        micro_image [
            shape=none
            image="icons/doc_jpg/pc.png"
            label=none
        ];

        micro_port1 -> micro_image [color=none, penwidth=1, weight=10];
    }

    sw1_port5 -> micro_port1 [minlen=20, weight=20];
    modem_port3 -> sw1_port8 [minlen=20, weight=20];
    sw1_port7 -> sw2_port4 [minlen=20, weight=20];

}
